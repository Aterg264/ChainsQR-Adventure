<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Aventura Bosque</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icon-192.png" />
  <meta name="theme-color" content="#4CAF50" />
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }
  </script>
  <style>
    body { font-family: Arial; padding: 20px; background: #f0f0f0; }
    .scene { display: none; margin-top: 20px; }
    button { margin: 10px 0; display: block; padding: 10px; }
  </style>
</head>
<body>
  <h1>🌲 Aventura en el Bosque 🌲</h1>
  <p>Estás frente a tres caminos. ¿Cuál eliges?</p>

  <button onclick="showScene('izquierda')">Camino de la izquierda</button>
  <button onclick="showScene('centro')">Camino del centro</button>
  <button onclick="showScene('derecha')">Camino de la derecha</button>

  <div id="izquierda" class="scene">
    <h2>🌳 Bosque profundo</h2>
    <p>Encuentras una piedra con un mensaje: "Busca la luz donde no hay sombra."</p>
  </div>

  <div id="centro" class="scene">
    <h2>🪨 Sendero de rocas</h2>
    <p>Encuentras una llave brillante en el suelo.</p>
  </div>

  <div id="derecha" class="scene">
    <h2>🌉 Puente colgante</h2>
    <p>El puente cruje, pero al cruzarlo ves un cofre cerrado.</p>
  </div>

  <script>
    function showScene(id) {
      document.querySelectorAll('.scene').forEach(div => div.style.display = 'none');
      document.getElementById(id).style.display = 'block';
    }
  </script>

  <button id="btn-get">Leer valor</button>
<button id="btn-set">Actualizar valor</button>
<button id="btn-append">Añadir fila</button>

<div id="salida"></div>

<script>
  const SCRIPT_URL = 'PEGAR_AQUI_LA_URL_DEL_WEBAPP'; // .../exec
  const HOJA = 'Hoja1';

  async function api(params) {
    const url = SCRIPT_URL + '?' + new URLSearchParams(params).toString();
    const res = await fetch(url, { method: 'GET' });
    if (!res.ok) throw new Error('HTTP ' + res.status);
    return res.json();
  }

  // 1) Leer un valor concreto (p. ej., B2)
  document.getElementById('btn-get').addEventListener('click', async () => {
    try {
      const data = await api({ action: 'get', range: `${HOJA}!B2` });
      document.getElementById('salida').textContent = data.ok
        ? `Valor en B2: ${data.value}`
        : `Error: ${data.error}`;
    } catch (e) {
      document.getElementById('salida').textContent = 'Error leyendo: ' + e.message;
    }
  });

  // 2) Modificar (set) el valor de una celda (p. ej., B2)
  document.getElementById('btn-set').addEventListener('click', async () => {
    try {
      const nuevo = prompt('Nuevo valor para B2:', 'Texto nuevo');
      if (nuevo == null) return;
      const data = await api({ action: 'set', range: `${HOJA}!B2`, value: nuevo });
      document.getElementById('salida').textContent = data.ok ? 'Actualizado OK' : `Error: ${data.error}`;
    } catch (e) {
      document.getElementById('salida').textContent = 'Error actualizando: ' + e.message;
    }
  });

  // 3) Añadir una nueva fila al final (append)
  document.getElementById('btn-append').addEventListener('click', async () => {
    try {
      const col1 = prompt('Columna 1:', 'valor1') ?? '';
      const col2 = prompt('Columna 2:', 'valor2') ?? '';
      const col3 = prompt('Columna 3:', 'valor3') ?? '';
      const values = JSON.stringify([col1, col2, col3]);
      const data = await api({ action: 'append', sheet: HOJA, values });
      document.getElementById('salida').textContent = data.ok ? 'Fila añadida' : `Error: ${data.error}`;
    } catch (e) {
      document.getElementById('salida').textContent = 'Error añadiendo: ' + e.message;
    }
  });
</script>

</body>
</html>
